# 이런 고민을 해보았어요

> [레이싱 게임 설계/구현기](https://vanillacake369.notion.site/36d8e23e07f24ea491a02c493199e87a?pvs=4)

- 외부에서 서비스를 컨트롤러에 주입하며, 컨트롤러는 주입받은 서비스를 의존(사용)합니다.
- 컨트롤러와 서비스는 하나만의 싱글톤 인스턴스를 사용하게끔 하였습니다.
- 각 도메인에 대해서 생성자가 아닌 정적 팩토리 메서드를 사용하여 생성하게끔 하였습니다.
    - 이를 통해 가독성을 높이고 확장성을 높였습니다.
- 입력에 대한 DTO, Validator와 Mapper 구조로 나누어보았습니다.
- 입력에 대한 Validate 시, 함수형 인터페이스를 활용해보았습니다.
- 인스턴스를 생성하지 않고 기능을 제공하는 클래스는 utils와 같이, finalize하고, 메서드들을 static으로 두었습니다.
    - RaceView, DtoMapper, StringParser, MoveStrategy
- 정렬을 위한 CompareTo 재정의 구현 시, Integer.compare()를 사용하여, overflow 를 방지했습니다.
- 만약 동순위의 자동차라면, 이름 순으로 정렬되게끔 Comparator 를 사용하였습니다.
- 전진조건에 대해 MoveStrategy로 따로 분리하였습니다. 전진조건이 바뀐다면, MoveStrategy 만 수정하면 되도록하였습니다.
- 최대한 testable하게 구현하였습니다 :: 외부에서 값을 주입하여 출력값을 반환하도록 구현하였습니다.
- test에도 필요없고 확장되면 안 되는 메서드/필드는 private으로, test에 필요하며, 동일한 패키지 내에서 활용되는 메서드/필드는 package-private으로 하였습니다.

# 이런 부분을 리뷰해주시면 좋을 거 같아요

- 메서드 네이밍이 어색하진 않을까요?
- ResponseDto는 없어도 괜찮겠다 싶어 만들지 않았습니다. 혹시 만드는 게 좋을까요??
- 각각의 도메인의 역할 분리가 어색하진 않을까요?
- 확장성을 낮추는 구현부분은 없을까요?
- 예외케이스나, 각 메서드 별 단위테스트를 놓친 부분은 없을까요?
-

# 도메인 구조

### Car

- Car :: 자동차 인스턴스
- CarDto :: Car에 대한 사용자 입력
- CarDtoValidator :: CarDto 검증
- CarDtoMapper :: CarDto -> Car에 매핑

### Round

- RoundDto :: 시도횟수에 대한 사용자 입력
- RoundDtoValidator :: RoundDto 검증
- RoundDtoMapper :: RoundDto를 Long 타입의 round(시도횟수)에 매핑

## Utils

- [x] MoveStrategy :: 전진조건 연산
- [x] StringParser :: String -> String[] 에 파싱

# 기능 구현사항

## RaceController

- 이름 입력에 따른 경주 자동차들 가져오는 서비스 호출
- 횟수 입력에 따른 게임 실행 서비스 호출
- 모든 입력에 대해 예외케이스 검증 호출
- 자동차 위치에 따른 우승자들 가져오는 서비스 호출

### RaceService

- 경주 자동차 이름입력에 따른 경주 자동차들 생성 서비스
- 횟수 입력에 따른 게임 실행 서비스
- 자동차 위치에 따른 우승자들 가져오는 서비스 호출

## RaceView

- 각 입력안내 뷰 호출
- 최종 우승자들을 화면에 출력하는 뷰 호출

# 예외처리

## 예외 케이스들

### 자동차 입력

- 이름이 5자를 초과하면 예외를 발생한다.
- 이름에 ","를 제외한 숫자나 입력되면 예외를 발생한다.
- 이름에 ","를 제외한 특수문자가 입력되면 예외를 발생한다.
- 이름에 ","를 제외한 이모지가 입력되면 예외를 발생한다.

### 시도 횟수 입력

- 횟수 입력에 숫자가 아닌 문자가 입력되면 예외를 발생한다.
- 횟수 입력은 정수가 아닌 숫자가 입력되면 예외를 발생한다.

    