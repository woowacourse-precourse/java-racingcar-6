# 🚗자동차 경주🚙

플레이어가 자동차의 이름을 정하고, 시도 횟수를 입력해 진행하는 자동차 경주 게임

- 0~9 중에서 랜덤으로 숫자를 생성하고 그 숫자가 4이상일 때 자동차가 한 칸 전진하는 규칙
- 입력했던 시도 횟수만큼 경주를 진행하고, 그 횟수가 끝나면 최종 우승자가 나오는 규칙(동시 우승 가능)
  <br>
  <br>

## 시나리오

**1️⃣ 자동차 경주 게임을 시작하기 위한 문구 출력**

```
경주할 자동차 이름을 입력하세요.(이름은 쉼표(,) 기준으로 구분)
```

<br>
<br>

**2️⃣ 컴퓨터 -> 0에서 9까지의 숫자 중 무작위의 값을 구한 후, 무작위 값이 4 이상인 경우 전진하도록 설정**
<br>
<br>

**3️⃣ 플레이어 -> 자동차 경주 게임의 자동차 이름 입력**

- [E1] 입력값이 없는 경우 : 자동차 이름이 공백인 경우와, 자동차 이름 사이의 공백이 발생한 경우 2가지로 구분
- [E2] 입력값의 끝에 쉼표(,)가 입력된 경우 : 해당 경우는 자동차 이름의 최소 길이를 만족하지 못했을 때의 결과 메시지를 내보낼 수 있도록 포함하여 구분
- [E3] 자동차 이름의 글자수가 잘못된 경우 : 1자리 미만인 경우와, 5자리 초과인 경우 2가지로 구분
- [E4] 자동차 이름이 중복된 경우 : 플레이어가 동일한 자동차 이름을 입력한 경우 1가지로 구분
  <br>
  <br>

**4️⃣ 플레이어 -> 시도 횟수 입력**

```
시도할 회수는 몇회인가요?
```

- [E1] 시도 횟수의 입력값이 없는 경우 : 공백이 발생한 경우 1가지로 구분
- [E2] 시도 횟수가 숫자가 아닌 문자인 경우 : 문자(a, b, c, ㄱ, ㄴ, ㄷ, ㅏ, ㅑ…)인 경우와 특수문자(! @ # $ % & _ - / = : ; , . ' " …)인 경우를 1가지로 모두 포함하여
  구분
  <br>
  <br>

**5️⃣ 컴퓨터 -> 플레이어에게 입력받은 자동차 이름과 시도 횟수에 맞추어 2번의 설정을 적용하며 자동차 경주 게임을 실행**
<br>
<br>

**6️⃣ 자동차 경주 게임 실행 결과 출력**

- "실행 결과" 메시지는 초기 1번만, 그 이후 차수별 결과는 Enter 공백으로 구분<br><br>
    ```예시```
    ```
    실행 결과
    pobi : -
    woni :
    jun : -
    
    pobi : --
    woni : -
    jun : --
    
    pobi : ---
    woni : --
    jun : ---
    
    pobi : ----
    woni : ---
    jun : ----
    
    pobi : -----
    woni : ----
    jun : -----
    ```

<br>
<br>

**7️⃣ 최종 우승자 출력**

- 여러 자동차 우승자 선정 가능<br><br>
    ```예시```
    ```
    최종 우승자 : pobi, jun
    ```

<br>

---

#### 📍2번과 6번 과정의 예외를 별도로 설정하지 않은 이유

- 2번
    - 무작위 값에 따른 전진 여부 설정은 명시적인 규칙이며 ```camp.nextstep.edu.missionutils.Randoms```를 가져와 사용하기 때문에 예외 처리를 설정하지 않아도 된다고
      판단했습니다.
- 6번
    - 최종 우승자 출력은 게임 종료 이후 실행되며 게임 실행에 예외가 발생하지 않으면 결과도 예외가 발생할 수 없기 때문에 예외 처리 설정은 불필요하다고 판단했습니다.

이 부분에 대해서는 모두가 기준으로 삼는 예외처리의 범주가 다를 것이라 생각하기 때문에 한가지 의견으로 봐주시면 좋겠습니다🙇‍♀️

---
<br>
<br>
<br>

## 기능 목록

```🏎 Domain```

- Car
    - 자동차 경주 게임의 자동차 관련 기능
        - 자동차의 이름을 가져온다.
        - 자동차의 위치를 트래킹하고, 전진 함수를 실행한다.
          <br>

- Game
    - 자동차 경주 게임의 게임 진행 전반 관련 기능
        - 게임의 초기화 : 게임을 시작할 때, 입력된 자동차 이름과 시도 횟수를 설정한다.
        - 자동차 목록 관리 : 게임에 참여하는 자동차 이름을 저장하고 관리한다.
        - 시도 횟수 관리 : 시도 횟수를 추적하고, 그 횟수에 도달하면 게임을 종료한다.
        - 게임 상태 추적 : 게임의 진행 중, 종료 여부를 확인해 게임 상태를 관리한다.

<br>
<br>

```🏎 Repository```

- CarRepository
    - 자동차의 이름을 저장하고 관리하는 기능
      <br>

- GameRepository
    - 자동차 경주 게임의 진행 상태를 파악해 종료 여부를 확인 및 저장하고 관리하는 기능

<br>
<br>

```🏎 Controller```

- RacingcargameController
    - 자동차 경주 게임의 전체 로직 관리 기능
        - 자동차 경주 게임을 시작하고, 플레이어에게 **유효한** 자동차의 이름과 시도 횟수를 입력받아 저장한다.
        - 게임을 위한 초기화를 하고, 차수별로 경주를 진행한다.
        - 게임의 차수별 결과를 모두 출력하고, 차수가 종료되면 최종 우승자를 출력한다.

<br>
<br>

```🏎 Util```

- RandomNumberGenerator
    - 자동차 경주 게임의 랜덤 숫자 생성 기능
        - 자동차의 전진 여부를 무작위로 결정하기 위해 사용한다.
        - 전진 조건 : 0~9 사이의 무작위 값을 구한 후, 그 무작위 값이 4 이상일 경우에만 전진
          <br>

- StringToList
    - 차 이름과 시도 횟수를 List로 바꿔주는 기능
        - String 형태로 입력되는 차 이름과 시도 횟수를 List 형태로 변환해 정확히 입력값을 파악한다.
            - 시도 횟수의 경우, 제한값이 조건에 없기 때문에 List에 저장하기로 결정

<br>
<br>

```🏎 Service```

- GameFlowManagementService
    - 자동차 경주 게임 진행 관련 로직을 처리하고, 게임의 진행 상태를 관리하는 기능
        - 게임 진행 관리 : 각 차수별 게임을 진행하고 자동차들의 전진 여부를 결정한다.
        - 우승자 조회 : 게임에서 우승한 자동차 이름을 가져온다.
        - 게임 종료 여부 확인: 모든 차수의 게임이 종료되었는지 확인한다.
        - 게임 데이터 저장 : 현재의 게임 데이터를 저장한다.

<br>
<br>

```🏎 View```

- InputView
    - 사용자에게 차 이름과 시도 횟수를 입력하도록 프롬프트를 보여주는 기능
      ```
      경주할 자동차 이름을 입력하세요.(이름은 쉼표(,) 기준으로 구분)
      ```
      ```
      시도할 회수는 몇회인가요?
      ```
      <br>

- OutputView
    - 자동차 경주 게임의 차수별 실행 결과와 최종 우승자를 출력하는 기능(아래는 예시)
      ```
      실행 결과
      pobi : -
      woni :
      jun : -
      
      pobi : --
      woni : -
      jun : --
      
      pobi : ---
      woni : --
      jun : ---
      
      pobi : ----
      woni : ---
      jun : ----
      
      pobi : -----
      woni : ----
      jun : -----
      
      최종 우승자 : pobi, jun
      ```
  <br>
  <br>

```🏎 Exception```

- CarNameException
    - 자동차 이름과 관련된 예외를 처리하는 기능
        - [E1] 입력값이 없는 경우를 체크한다.
            - 자동차 이름이 아예 입력되지 않은 경우
            - 하나의 자동차 이름 사이의 공백이 발생한 경우
        - [E2] 입력값의 끝에 쉼표(,)가 입력된 경우를 체크한다.
        - [E3] 자동차 이름의 글자수가 잘못된 경우를 체크한다.
            - 1자리 미만일 경우
            - 5자리 초과일 경우
        - [E4] 자동차 이름이 중복된 경우를 체크한다.
          <br>

- TryCountNumberException
    - 시도 횟수와 관련된 예외를 처리하는 기능
        - [E1] 시도 횟수의 입력값이 없는 경우를 체크한다.
        - [E2] 시도 횟수가 숫자가 아닌 문자인 경우를 체크한다.
            - 문자(a,b,c,ㄱ,ㄴ,ㄷ...)인 경우와 특수문자(! @ # $ % & _ - / = : ; , . ' ")인 경우 모두 포함

<br>
<br>

---

## 궁금했어요

**개발하면서 궁금했던 부분들에 대한 정리**

### 😎 Java의 예외처리 우선순위는 어떻게 해야 테스트 오류가 나지 않을까?
- 먼저 [테스트의 기본 정보 학습](https://velog.io/@pu1etproof/2%EC%9E%A5-%ED%85%8C%EC%8A%A4%ED%8A%B8)을 통해 테스트 코드를 작성하는 방법을 배움.
- 그렇게 CarNameException의 테스트 코드를 작성하던 중 fail되는 예외가 많아 코드 안에서의 순서를 바꾸자 통과하지 못했던 테스트가 통과했음.
- 메서드 내부 로직의 순서가 변경될 때 테스트가 실패하는 이유는 아래의 2가지로 볼 수 있었음.
  - 예외 조건을 검사하는 순서에 따라 예외가 발생하는 조건이 달라지기 때문.
  - **의존 관계**에 의해 순서에 따른 다른 결과가 발생할 수 있기 때문.
- 그 이후, Java의 예외 처리는 의존 관계와 검사 순서를 고려하며 작성하는 연습을 하고 있음👍

---

## 배웠어요

**개발을 진행하며 겪었던 문제들의 트러블슈팅을 [velog](https://velog.io/@dlgkdis801/%EC%9A%B0%EC%95%84%ED%95%9C%ED%85%8C%ED%81%AC%EC%BD%94%EC%8A%A4-6%EA%B8%B0-%ED%94%84%EB%A6%AC%EC%BD%94%EC%8A%A4-2%EC%A3%BC%EC%B0%A8-%EC%9E%90%EB%8F%99%EC%B0%A8-%EA%B2%BD%EC%A3%BC#3%EF%B8%8F%E2%83%A3-%ED%85%8C%EC%8A%A4%ED%8A%B8-%ED%86%B5%EA%B3%BC%EA%B0%80-%EB%90%98%EC%A7%80-%EC%95%8A%EC%95%84)에 정리**(2주차 미션이 끝난 이후 공개 예정)

### ⚙️ 코드 실행 로직 오류 발생

- 상세 내용<br> : 플레이어가 자동차 이름과 시도 횟수를 입력하면 각 차수별로 "실행결과"와 "최종 우승자 : "가 출력되는 현상
  ```
  경주할 자동차 이름을 입력하세요.(이름은 쉼표(,) 기준으로 구분)
  pobi,woni,jun
  시도할 회수는 몇회인가요?
  5
  
  실행 결과
  pobi : ---
  woni : ---
  jun : ---
  
  최종 우승자: pobi, woni, jun
  실행 결과
  pobi : ----
  woni : --
  jun : ---
  
  최종 우승자: pobi
  실행 결과
  pobi : ---
  woni : --
  jun : --
  
  최종 우승자: pobi
  실행 결과
  pobi : --
  woni : ----
  jun : ----
  
  최종 우승자: woni, jun
  실행 결과
  pobi : ----
  woni : --
  jun : -
  
  최종 우승자: pobi
  ```
  <br>
- 해결 방법<br>
  - 원인을 찾기 위해 Car.java 파일의 tryCount를 중심으로 확인했으며, Race.java 파일의 누적된 우승자를 가져오는 부분을 중점적으로 수정했으나 적용되지 않음.
  - 해결이 어려움🫨
<br>
<br>

### ⛔️ 예외 처리가 안된다...?

- 상세 내용<br> : IllegalArgumentException이 발생되어야 하지만<br>
  -> CarNameException의 경우 예외 처리가 아예 발생되지 않는다.<br>
  ->TryCountException의 경우 NumberFormatException이 발생한다.<br>
<br>

- 해결 방법
  - ```Exception/CarNameException.java```를 확인<br>
      ```java
      package racingcar.Exception;
    
      public class CarNameException extends IllegalArgumentException {
      public CarNameException() {
      super("자동차 이름은 1자 이상, 5자 이하만 가능합니다.");
      }
    
          public static void validateCarName(String name) {
              if (name == null || name.length() < 1 || name.length() > 5) {
                  throw new CarNameException();
              }
          }
      }
      ```
    이렇게 validateCarName을 통해 이름의 길이가 공백이거나, 1 이하, 5 이상일 때 IllegalArgumentException이 발생되도록 로직을 구성해으나, 아예 예외로 처리되지 않았음.
  - 3가지를 한번에 처리하지 않도록 수정
    ```java
    public class CarValidator {
        public static void validateCarName(String name) {
            if (name == null) {
                throw new CarNameNullException();
            }
            if (name.length() < 1 || name.length() > 5) {
                throw new CarNameLengthException();
            }
        }
    }
    ```
    <br>
    여전히 작동하지 않았음.<br>
    
    ```
    경주할 자동차 이름을 입력하세요.(이름은 쉼표(,) 기준으로 구분)
    pobi,woni, juddddddddddn
    시도할 회수는 몇회인가요?
    |
    ```
    
  - 해결이 어려움🫨
<br>
<br>

### ❌ 테스트 통과가 되지 않는다...!

- 상세 내용<br> : 기본적으로 주어진 테스트는 2가지인데,<br>
  -> 전진_정지()에서 test failed가 발생!<br>
  -> 신기하게도 그 다음의 예외 처리는 정상적으로 테스트가 통과한다? 분명 예외로 처리가 안되고 경주가 진행되었는데 말이다🧐<br>
<br>

- 해결 방법
  - "전진_정지()"는 위의 입출력 오류의 전이 현상으로 파악함.
  - 따라서, 테스트가 통과되지 않는 것으로 판단.
  - 지금까지의 코드에서 너무 많은 오류의 전이가 일어남.
  - 해결이 어려움🫨
<br>
<br>

---

### ✏️ 따라서 **자동차 경주 게임의 모든 코드를 처음부터 재구성하는 방식으로** 해결 ✏️
- 불필요한 제거 작업을 최소화하기 위해 별도의 프로젝트에서 트러블 슈팅을 거쳤습니다.
- 따라서, 현재의 패키지 구조와 코드는 위의 트러블슈팅 과정을 거쳐 재편된 버전임을 알립니다!

---
